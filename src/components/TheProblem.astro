---
/**
 * TheProblem â€” Act II
 * Dark section - mobile: image first, text centered
 */
import { t } from '../i18n/utils';
import { getLocaleFromPath } from '../i18n/config';

// Get locale from prop or URL
const { lang } = Astro.props;
const currentLocale = lang || getLocaleFromPath(Astro.url.pathname);
const isFrench = currentLocale === 'fr';

// Dynamic links
const manifestoLink = isFrench ? '/fr/manifeste' : '/manifesto';
---

<section 
  id="problem" 
  class="relative flex items-center justify-center px-6 py-16 md:py-24 bg-[#2B2B2B] text-[#F2F0E9] overflow-hidden"
>
  <!-- Subtle grain overlay -->
  <div class="absolute inset-0 opacity-[0.03] pointer-events-none">
    <svg class="w-full h-full">
      <filter id="grain">
        <feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="4" stitchTiles="stitch" />
      </filter>
      <rect width="100%" height="100%" filter="url(#grain)" />
    </svg>
  </div>

  <div class="relative z-10 max-w-4xl mx-auto flex flex-col lg:flex-row items-center gap-10 lg:gap-16">
    <!-- Image FIRST on mobile (flex-col-reverse for text to show after) -->
    <div class="problem-image lg:flex-1 flex justify-center order-first lg:order-last">
      <img 
        src="/cornish-cross.png" 
        alt="Cornish Cross chicken in pasture" 
        loading="lazy"
        class="w-56 h-56 md:w-72 md:h-72 lg:w-96 lg:h-96 object-cover rounded-full shadow-2xl ring-4 ring-[#C8A97E]/20"
      />
    </div>
    
    <!-- Text Content - centered on mobile -->
    <div class="problem-text space-y-6 text-lg md:text-xl lg:text-2xl leading-relaxed font-['EB_Garamond',serif] lg:flex-1 text-center lg:text-left">
      <p class="problem-line">
        {t('problem.line1', currentLocale)}
      </p>
      <p class="problem-line">
        {t('problem.line2', currentLocale)}
      </p>
      <p class="problem-line">
        {t('problem.line3', currentLocale)}
      </p>
      <p class="problem-line text-[#C8A97E] font-medium">
        {t('problem.line4', currentLocale)}
      </p>
      <div class="pt-4">
        <a 
          href={manifestoLink}
          class="inline-block px-8 py-3 bg-[#C8A97E] text-[#1a1a1a] font-['JetBrains_Mono',monospace] text-sm tracking-[0.15em] uppercase hover:bg-[#F2F0E9] transition-colors duration-300"
        >
          {t('problem.manifestoBtn', currentLocale)}
        </a>
      </div>
    </div>
  </div>
</section>
