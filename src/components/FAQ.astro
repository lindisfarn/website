---
/**
 * FAQ â€” Frequently Asked Questions
 * Accordion-style toggles with answers + FAQPage schema markup
 */
import { getTranslations } from '../i18n/utils';
import { getLocaleFromPath } from '../i18n/config';

// Get locale from prop or URL
const { lang } = Astro.props;
const currentLocale = lang || getLocaleFromPath(Astro.url.pathname);
const t = getTranslations(currentLocale);

// Generate FAQPage schema
const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": t.faq.items.map((faq: any) => ({
    "@type": "Question",
    "name": faq.q,
    "acceptedAnswer": {
      "@type": "Answer",
      "text": faq.a
    }
  }))
};
---

<section 
  id="faq" 
  class="relative px-6 py-20 md:py-28 bg-[#2B2B2B]"
>
  <div class="max-w-3xl mx-auto">
    
    <!-- Section Label -->
    <p class="text-center text-xs tracking-[0.3em] uppercase text-[#C8A97E] mb-4 font-['JetBrains_Mono',monospace]">
      {t.faq.label}
    </p>
    
    <!-- Section Title -->
    <h2 class="text-center font-['Cormorant_Garamond',serif] text-3xl md:text-4xl lg:text-5xl text-[#F2F0E9] mb-12 md:mb-16">
      {t.faq.title}
    </h2>

    <!-- FAQ Accordion -->
    <div class="space-y-4">
      {t.faq.items.map((faq: any, index: number) => (
        <details class="group bg-[#F2F0E9]/5 border border-[#F2F0E9]/10 rounded-xl overflow-hidden">
          <summary class="flex items-center justify-between cursor-pointer p-5 md:p-6 list-none">
            <h3 class="font-['Cormorant_Garamond',serif] text-lg md:text-xl text-[#F2F0E9] pr-4">
              {faq.q}
            </h3>
            <span class="flex-shrink-0 w-8 h-8 rounded-full bg-[#C8A97E]/20 flex items-center justify-center transition-transform duration-300 group-open:rotate-45">
              <svg class="w-4 h-4 text-[#C8A97E]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v12m6-6H6"></path>
              </svg>
            </span>
          </summary>
          <div class="px-5 pb-5 md:px-6 md:pb-6">
            <p class="font-['EB_Garamond',serif] text-base md:text-lg text-[#F2F0E9]/80 leading-relaxed">
              {faq.a}
            </p>
          </div>
        </details>
      ))}
    </div>

  </div>
</section>

<!-- FAQPage Schema Markup -->
<script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />
<style>
  /* Remove default marker */
  details summary::-webkit-details-marker {
    display: none;
  }
  
  details summary::marker {
    display: none;
  }
</style>
